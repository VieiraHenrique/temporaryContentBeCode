# Middlewares

---

Middlewares is code that runs between the request and the response.

We receive a request, we perform some logic (middleware) and then send some response.

The `use()` method in `express` is generally used to run some middleware code.

We don't need to have just one middleware. We can chain many functions to be ran in the server before sending a response.

Technically, all the code you run in the callback of a `app.get('/', callback)` is a middleware : some logic you implement before sending a response.

The difference is that a `get('/', callback)` will run a function in a specifc case (a `GET` request to a specific route `/`)

The `use()` method is ran everytime a request comes in. The advantage is that it has access to the `request` object with all its info. We could then "pre-process" the data from the request to then "serve" it to the different routes it can be used by.

One very usefull case for middlewares is `authentication`. For example, verify if the user is logged in and check if he's authorized to get the requested data.

---

You can create your own middlewares and also use some premade middlewares.

One very common is the [body parser](https://www.npmjs.com/package/body-parser) middleware that comes now builtin with Express.

What does it do ?

It parses the body of the request and make it available in the req.body object.

Let's try this :

- Create an express server and listen to it.
- Make it that when you get a `POST` request to `/` you log to the console the body of it.
- With Postman, send a `POST` request to `/`. The body should be `x-www-form-urlencoded` type and the key/value pairs as you wish. (We are emulating here the sending of a form data)

What prints to the console ? `undefined`

That's because the body wasn't parsed.

- Use body-parser to parse the `urlencoded` data you received from the request.
- You should now have access to the data you received from the request.

This data could be an user login info that should be compared to the database in order to check if the user exists and then log him in.
